<!DOCTYPE html>
<html>
<head>
    <title>Tracking</title>

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        button {
            padding: 6px 10px;
            cursor: pointer;
        }

        /* ONLY CHANGE â€” RED BUTTONS WITH WHITE TEXT */
        #exportBtn,
        #returnDashboardBtn {
            background-color: red !important;
            color: white !important;
        }

    </style>
</head>

<body>

    <h2>Donor Tracking</h2>

    <!-- Buttons -->
    <button id="exportBtn" onclick="exportToGoogleSheet()">Export to CSV</button>
    <button id="returnDashboardBtn" onclick="window.location.href='dashboard.html'">
        Return to Dashboard
    </button>

    <br><br>

    <!-- Table -->
    <table>
        <thead>
            <tr>
                <th>Blood Type</th>
                <th>Rh</th>
                <th>Name</th>
                <th>Birthday</th>
                <th>Contact</th>
                <th>Serial</th>
            </tr>
        </thead>
        <tbody id="donorTable">
        </tbody>
    </table>

    <script>
        function loadDonors() {
            let donors = JSON.parse(localStorage.getItem("donors")) || [];
            let table = document.getElementById("donorTable");
            table.innerHTML = "";

            donors.forEach(donor => {
                let row = `
                    <tr>
                        <td>${donor.bloodType || ""}</td>
                        <td>${donor.rhFactor || ""}</td>
                        <td>${donor.firstName || ""} ${donor.middleName || ""} ${donor.surname || ""}</td>
                        <td>${donor.birthday || ""}</td>
                        <td>${donor.contact || ""}</td>
                        <td>${donor.serial || ""}</td>
                    </tr>
                `;
                table.innerHTML += row;
            });
        }

        function exportToGoogleSheet() {
            let donors = JSON.parse(localStorage.getItem("donors")) || [];

            let csv = "Blood Type,Rh Factor,First Name,Middle Name,Surname,Birthday,Contact,Serial\n";

            donors.forEach(donor => {
                csv += 
                    (donor.bloodType || "") + "," +
                    (donor.rhFactor || "") + "," +
                    (donor.firstName || "") + "," +
                    (donor.middleName || "") + "," +
                    (donor.surname || "") + "," +
                    (donor.birthday || "") + "," +
                    (donor.contact || "") + "," +
                    (donor.serial || "") + "\n";
            });

            let blob = new Blob([csv], { type: "text/csv" });
            let url = window.URL.createObjectURL(blob);
            let a = document.createElement("a");
            a.href = url;
            a.download = "donors.csv";
            a.click();
            window.URL.revokeObjectURL(url);
        }

        loadDonors();
    </script>

</body>
</html>
